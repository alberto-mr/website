---
import BaseLayout from '../layouts/BaseLayout.astro';
import { getPublicationsByResearchArea, generateBibTeX } from '../utils/publications';

const relatedPublications = getPublicationsByResearchArea('deceptive', 1000);
---

<BaseLayout title="Deceptive Designs" description="Research on dark patterns and deceptive UX designs">
  <section class="container" style="padding: 4rem 0;">
    <h1 class="section-title" style="margin-bottom: 1rem;">Deceptive Designs</h1>
    <p class="lead" style="color: var(--text-secondary); max-width: 70ch; text-align: center; margin: 0 auto;">
      Research on dark patterns and manipulative interface strategies that capture and exploit user attention, 
      their impact on user autonomy and wellbeing, and approaches to identify, measure, and mitigate them in practice. 
      My work focuses on understanding how digital interfaces steal attention and developing design heuristics 
      that respect rather than exploit user attention.
    </p>

    <div class="research-grid" style="margin-top: 2rem;">
      <div class="research-card" data-aos="fade-up">
        <div class="card-icon">
          <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <path d="M9.5 2A2.5 2.5 0 0 1 12 4.5v15a2.5 2.5 0 0 1-4.96.44 2.5 2.5 0 0 1-2.96-3.08 3 3 0 0 1 .34-4.58 2.5 2.5 0 0 1 1.32-4.24 2.5 2.5 0 0 1 1.98-3A2.5 2.5 0 0 1 9.5 2Z"/>
            <path d="M14.5 2A2.5 2.5 0 0 0 12 4.5v15a2.5 2.5 0 0 0 4.96.44 2.5 2.5 0 0 0 2.96-3.08 3 3 0 0 0-.34-4.58 2.5 2.5 0 0 0-1.32-4.24 2.5 2.5 0 0 0-1.98-3A2.5 2.5 0 0 0 14.5 2Z"/>
            <path d="M12 8v8"/>
            <path d="M8 12h8"/>
          </svg>
        </div>
        <h3>Attention-Capture Damaging Patterns</h3>
        <p>Defining and identifying attention capture deceptive designs in digital interfaces, understanding how dark patterns steal user attention.</p>
        
        <div class="examples-section">
          <h4>Examples</h4>
          <div class="card-actions">
            <a href="https://attentioncapture.com/" class="btn btn-primary btn-sm" target="_blank">
              <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                <path d="M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6"/>
                <polyline points="15,3 21,3 21,9"/>
                <line x1="10" y1="14" x2="21" y2="3"/>
              </svg>
              ACDPs Typology
            </a>
          </div>
        </div>
      </div>
      <div class="research-card" data-aos="fade-up" data-aos-delay="100">
        <div class="card-icon">
          <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <path d="M9 12l2 2 4-4"/>
            <path d="M21 12c0 4.97-4.03 9-9 9s-9-4.03-9-9 4.03-9 9-9 9 4.03 9 9z"/>
            <path d="M12 1v6m0 6v6m11-7h-6m-6 0H1"/>
          </svg>
        </div>
        <h3>Digital Attention Heuristics</h3>
        <p>Developing design heuristics and frameworks that support user attention by design, creating interfaces that respect rather than exploit attention.</p>
        
        <div class="examples-section">
          <h4>Examples</h4>
          <div class="card-actions">
            <a href="https://osf.io/8btqk" class="btn btn-primary btn-sm" target="_blank">
              <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                <path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"/>
                <polyline points="14,2 14,8 20,8"/>
                <line x1="16" y1="13" x2="8" y2="13"/>
                <line x1="16" y1="17" x2="8" y2="17"/>
                <polyline points="10,9 9,9 8,9"/>
              </svg>
              Design Heuristics PDF
            </a>
          </div>
        </div>
      </div>
      <div class="research-card" data-aos="fade-up" data-aos-delay="200">
        <div class="card-icon">
          <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <path d="M20.84 4.61a5.5 5.5 0 0 0-7.78 0L12 5.67l-1.06-1.06a5.5 5.5 0 0 0-7.78 7.78l1.06 1.06L12 21.23l7.78-7.78 1.06-1.06a5.5 5.5 0 0 0 0-7.78z"/>
            <circle cx="12" cy="12" r="3"/>
            <path d="M12 1v6m0 6v6m11-7h-6m-6 0H1"/>
          </svg>
        </div>
        <h3>Wellbeing‑Focused Design</h3>
        <p>Bridging digital wellbeing and usability through design interfaces that respect user attention and promote meaningful interactions.</p>
        
        <div class="examples-section">
          <h4>Examples</h4>
          <div class="card-actions">
            <a href="https://www.figma.com/community/plugin/1310606990428971215/digital-wellbeing-lens" class="btn btn-primary btn-sm" target="_blank">
              <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                <path d="M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6"/>
                <polyline points="15,3 21,3 21,9"/>
                <line x1="10" y1="14" x2="21" y2="3"/>
              </svg>
              Digital Wellbeing Lens
            </a>
            <a href="https://www.figma.com/proto/VnUNKZiN7JWbzH4lmlWhkQ/EDDI-%F0%9F%9B%A0%EF%B8%8F?node-id=162-2227&t=i3iYlxDyFJVg5eeZ-1" class="btn btn-primary btn-sm" target="_blank">
              <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                <path d="M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6"/>
                <polyline points="15,3 21,3 21,9"/>
                <line x1="10" y1="14" x2="21" y2="3"/>
              </svg>
              EDDI by Pietro Martina
            </a>
          </div>
        </div>
      </div>
    </div>

  </section>


  <section class="container" style="padding: 2rem 0 4rem;">
    <h2 class="section-title" style="margin-bottom: 1rem;">Related Publications</h2>
    <div class="publications-list">
      {relatedPublications.map(pub => {
        const bibtex = generateBibTeX(pub);
        
        return (
          <div class="publication-entry">
            <div class="pub-year-badge">{pub.year}</div>
            <div class="pub-details">
              <h4><a href={pub.link} target="_blank" rel="noopener">{pub.title}</a></h4>
              <p>{pub.authors}, {pub.venue}</p>
              {pub.doi && (
                <p style="font-size: 0.9rem; color: var(--text-secondary); margin-top: 0.25rem;">
                  DOI: <a href={`https://doi.org/${pub.doi}`} target="_blank" rel="noopener" style="color: var(--accent-color);">{pub.doi}</a>
                </p>
              )}
              <div class="pub-actions" style="margin-top: 0.75rem; display: flex; gap: 0.75rem; align-items: center;">
                <button 
                  class="bibtex-download-btn" 
                  data-bibtex={JSON.stringify(bibtex)}
                  title="Copy BibTeX to clipboard"
                >
                  <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                    <rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect>
                    <path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path>
                  </svg>
                  Copy BibTeX
                </button>
              </div>
            </div>
          </div>
        );
      })}
    </div>
    <div class="view-all-pubs" style="margin-top: 2rem;">
      <a href="/publications/" class="btn">View all publications →</a>
    </div>
  </section>
</BaseLayout>

<script>
  function copyBibTeXToClipboard(bibtex) {
    navigator.clipboard.writeText(bibtex).then(() => {
      showToast('BibTeX copied to clipboard!');
    }).catch(err => {
      console.error('Failed to copy BibTeX: ', err);
      showToast('Failed to copy BibTeX', 'error');
    });
  }

  function showToast(message, type = 'success') {
    // Remove any existing toast
    const existingToast = document.querySelector('.toast');
    if (existingToast) {
      existingToast.remove();
    }

    // Create toast element
    const toast = document.createElement('div');
    toast.className = `toast toast-${type}`;
    toast.textContent = message;
    
    // Add to page
    document.body.appendChild(toast);
    
    // Force a reflow to ensure the element is rendered
    toast.offsetHeight;
    
    // Show toast with animation
    setTimeout(() => {
      toast.classList.add('toast-show');
    }, 10);
    
    // Hide and remove toast after 3 seconds
    setTimeout(() => {
      toast.classList.remove('toast-show');
      setTimeout(() => {
        if (toast.parentNode) {
          toast.parentNode.removeChild(toast);
        }
      }, 300);
    }, 3000);
  }

  // Add event listeners to all BibTeX copy buttons
  document.addEventListener('DOMContentLoaded', function() {
    const bibtexButtons = document.querySelectorAll('.bibtex-download-btn');
    
    bibtexButtons.forEach(button => {
      button.addEventListener('click', function() {
        const bibtex = this.getAttribute('data-bibtex');
        if (bibtex) {
          copyBibTeXToClipboard(JSON.parse(bibtex));
        }
      });
    });
  });
</script>

<style>
  .research-grid {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(320px, 1fr));
    gap: 2rem;
    margin: 2rem 0;
    align-items: stretch;
  }

  .research-card {
    background: white;
    padding: 2rem;
    border-radius: 12px;
    box-shadow: 0 4px 20px rgba(0, 0, 0, 0.1);
    border: 1px solid var(--border-color, #e5e7eb);
    transition: all 0.3s ease;
    text-align: center;
    display: flex;
    flex-direction: column;
    height: 100%;
  }

  .research-card:hover {
    transform: translateY(-5px);
    box-shadow: 0 8px 30px rgba(0, 0, 0, 0.15);
  }

  .card-icon {
    width: 60px;
    height: 60px;
    background: var(--gradient-primary, linear-gradient(135deg, #667eea 0%, #764ba2 100%));
    border-radius: 12px;
    display: flex;
    align-items: center;
    justify-content: center;
    margin: 0 auto 1.5rem;
    color: white;
  }

  .card-icon svg {
    width: 30px;
    height: 30px;
  }

  .research-card h3 {
    font-size: 1.25rem;
    font-weight: 600;
    margin-bottom: 1rem;
    color: var(--text-primary, #1f2937);
  }

  .research-card p {
    color: var(--text-secondary, #6b7280);
    line-height: 1.6;
    margin: 0 0 2rem 0;
    flex-grow: 1;
  }

  .examples-section {
    margin-top: auto;
    padding-top: 1.5rem;
    border-top: 1px solid var(--border-color, #e5e7eb);
  }

  .examples-section h4 {
    font-size: 0.85rem;
    font-weight: 600;
    color: var(--text-primary, #1f2937);
    margin-bottom: 1rem;
    text-transform: uppercase;
    letter-spacing: 0.1em;
    opacity: 0.8;
  }

  .card-actions {
    display: flex;
    gap: 0.75rem;
    flex-wrap: wrap;
    justify-content: center;
  }


  .btn-sm {
    padding: 0.7rem 1.3rem;
    font-size: 0.9rem;
    display: flex;
    align-items: center;
    gap: 0.5rem;
    border-radius: 8px;
    font-weight: 500;
    text-decoration: none;
    transition: all 0.3s ease;
    min-width: fit-content;
    white-space: nowrap;
  }

  .btn-primary {
    background: var(--gradient-primary, linear-gradient(135deg, #667eea 0%, #764ba2 100%));
    color: white;
    border: none;
  }

  .btn-primary:hover {
    transform: translateY(-2px);
    box-shadow: 0 4px 15px rgba(102, 126, 234, 0.4);
  }

  .btn-outline {
    background: transparent;
    color: var(--text-primary, #1f2937);
    border: 2px solid var(--accent-color, #667eea);
  }

  .btn-outline:hover {
    background: var(--accent-color, #667eea);
    color: white;
  }

  .btn-sm svg {
    width: 16px;
    height: 16px;
  }

  @media (max-width: 768px) {
    .research-grid {
      grid-template-columns: 1fr;
      gap: 1.5rem;
    }

    .research-card {
      padding: 1.5rem;
    }

    .card-icon {
      width: 50px;
      height: 50px;
    }

    .card-icon svg {
      width: 25px;
      height: 25px;
    }

    .card-actions {
      gap: 0.5rem;
    }
    
    .btn-sm {
      padding: 0.6rem 1rem;
      font-size: 0.85rem;
    }
  }
</style>
